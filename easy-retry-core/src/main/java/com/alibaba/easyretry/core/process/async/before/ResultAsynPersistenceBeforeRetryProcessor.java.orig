package com.alibaba.easyretry.core.process.async.before;

import java.util.Objects;

import com.alibaba.easyretry.common.AbstractResultPredicate;
import com.alibaba.easyretry.common.retryer.RetryerInfo;

/**
 * @author Created by wuhao on 2021/3/19.
 */
public class ResultAsynPersistenceBeforeRetryProcessor<R> extends
    AbstractAsyncPersistenceBeforeRetryProcessor<R> {

	private final R result;

<<<<<<< HEAD:easy-retry-core/src/main/java/com/alibaba/easyretry/core/process/asyn/before/ResultAsynPersistenceBeforeRetryProcessor.java
	public ResultAsynPersistenceBeforeRetryProcessor(R result, RetryerInfo<R> retryerInfo,
													 RetryConfiguration retryConfiguration) {
		super(retryerInfo, retryConfiguration);
=======
	public ResultAsynPersistenceBeforeRetryProcessor(R result, RetryerInfo<R> retryerInfo) {
		super(retryerInfo);
>>>>>>> origin/main:easy-retry-core/src/main/java/com/alibaba/easyretry/core/process/async/before/ResultAsynPersistenceBeforeRetryProcessor.java
		this.result = result;
	}

	@Override
	public boolean needRetry() {
		AbstractResultPredicate<R> easyRetryPredicate = retryerInfo.getResultPredicate();
		if (Objects.nonNull(easyRetryPredicate)) {
			return easyRetryPredicate.apply(result);
		} else {
			return false;
		}
	}

	@Override
	public R getResult() {
		return result;
	}
}
